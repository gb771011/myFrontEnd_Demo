<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script title="jQuary" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script title="google-code-prettify-" src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>Document</title>
</head>

<body>
    <article>
        <h2>使用$(<i>selector</i>).load()讀取資料</h2>
        <button id="btn1" type="button">Click me</button>
        <p id="result201" class="result">Loading...</p>
    </article>

    <article>
        <h2>使用$.ajax()讀取開放資料</h2>
        <p>來源: <a href="http://data.taipei/opendata/datalist/datasetMeta?oid=4d29818c-a3ee-425d-b88a-22ac0c24c712" target="_blank">臺北市今日施工資訊</a></p>
        <button id="btn2" type="button">Click me(.ajax)</button>

        <p id="result202">Data Here</p>
        <div>
            <h3>注意</h3>
            <p>因跨網域讀取資料會有安全上的問題，故使用chrome測試時，可以使用下列方式:</p>
            <ol>
                <li>把要測試的json下載回來，再將url調成本機端的位置後測試，並在chrome啟動時加上參數"--allow-file-access-from-files"(允許讀取本機端檔案)</li>
                <li>再chrome啟動時加上參數"--disable-web-security"(停止安全性檢查)</li>
                <li>若資料格式為json，可改用$.getJSON()</li>
            </ol>

            <p>實際應用時會透過自己的伺服器去獲得資料，或是使用jsonp格式</p>
        </div>
    </article>
    <article>
        <h2>$.getJson()</h2>
        <button id="btn3" type="button">Click me(.getJson)</button>
        <p id="result203">Data Here</p>
        <p>注意get有字數限制</p>
    </article>
    <script>
        var url1 = "http://data.taipei/opendata/datalist/apiAccess",
            data1 = {
                "scope": "resourceAquire",
                "rid": "201d8ae8-dffc-4d17-ae1f-e58d8a95b162"
                // "limit": 2
            },
            url1a = "http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&rid=201d8ae8-dffc-4d17-ae1f-e58d8a95b162";
        $(function () {
            $("#btn1").click(function () {
                $("#result201").load("ajax_test.txt");
            });
            $("#btn2").click(function () {
                $.ajax({
                    url: url1,
                    dataType: "json",
                    data: data1,
                    success: function (e) {
                        var data = e.result.results[0];
                        var cont = ""
                        for (i in data) {
                            console.log(i, ":", data[i]);
                            cont += '<p>' + i + " : " + data[i] + '</p>'
                        }
                        $("#result202").html(cont);

                    },
                    error: function () {
                        $("#result202").text("error");
                    }
                });
            });

            var urlBtn3 = "apiIn.json";
            $("#btn3").click(function () {
                $.getJSON(urlBtn3, function (e, status) {
                    console.log(status);
                    console.log(e);
                });
            });
        });
    </script>
</body>

</html>